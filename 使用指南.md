# 陌陌自动回复使用指南

## 一、安装应用

### 方法一：使用Android Studio编译安装

1. **准备工作**
   - 确保您的电脑已安装Android Studio
   - 确保您的Android设备已开启开发者选项和USB调试
   - 确保您的设备已通过USB连接到电脑

2. **编译安装步骤**
   - 打开Android Studio
   - 点击"Open"按钮，选择项目目录 `h:\AI临时\momo_auto_reply`
   - 等待项目同步完成
   - 点击顶部工具栏的 "Run" 按钮（绿色三角形）
   - 在弹出的设备选择窗口中选择您的Android设备
   - 等待编译和安装完成

### 方法二：直接生成APK文件

1. **生成APK步骤**
   - 打开Android Studio，加载项目
   - 点击顶部工具栏的 "Build" → "Build Bundle(s) / APK(s)" → "Build APK(s)"
   - 等待编译完成
   - 点击 "locate" 按钮，找到生成的APK文件
   - 将APK文件复制到您的Android设备上
   - 在设备上找到并点击APK文件进行安装

## 二、开启无障碍服务

这是应用正常工作的关键步骤，必须完成！

1. **打开应用**
   - 在您的Android设备上找到并打开"陌陌自动回复"应用

2. **开启无障碍服务**
   - 应用会自动弹出提示对话框，点击"开启无障碍服务"按钮
   - 系统会跳转到无障碍服务设置页面
   - 在列表中找到"陌陌自动回复"选项，点击进入
   - 开启"使用陌陌自动回复"开关
   - 系统会弹出权限请求对话框，点击"允许"

3. **返回应用确认**
   - 返回到"陌陌自动回复"应用
   - 检查状态显示为"服务已开启"，表示无障碍服务已成功开启

## 三、配置AI模型

默认情况下，应用使用OpenAI的GPT模型，您需要配置自己的API密钥：

### 方法一：修改代码重新编译

1. **打开代码文件**
   - 在Android Studio中找到 `AIReplyGenerator.java` 文件
   - 路径：`app/src/main/java/com/momoautoreply/AIReplyGenerator.java`

2. **修改API密钥**
   - 找到以下代码行：
     ```java
     String openaiApiKey = "your_openai_api_key"; // 替换为实际的API密钥
     ```
   - 将 `your_openai_api_key` 替换为您自己的OpenAI API密钥

3. **重新编译安装**
   - 点击"Run"按钮重新编译并安装应用

### 方法二：切换其他AI模型

如果您想使用其他AI模型（如百度文心一言、讯飞星火等），请修改以下代码：

```java
// 将默认模型从OPENAI切换为其他模型
private AIModel currentModel = AIModel.BAIDU_WENXIN; // 切换为百度文心一言
```

然后修改对应模型的配置：

```java
// 百度文心一言配置
String baiduApiKey = "your_baidu_api_key"; // 替换为实际的API密钥
String baiduSecretKey = "your_baidu_secret_key"; // 替换为实际的密钥
```

## 四、开始使用

1. **打开陌陌应用**
   - 在您的Android设备上打开陌陌应用
   - 进入任意聊天界面

2. **自动回复功能**
   - 当对方发送消息时，应用会自动：
     - 读取消息内容
     - 生成AI回复
     - 自动发送回复

3. **多用户支持**
   - 应用会自动识别不同的聊天用户
   - 为每个用户维护独立的对话历史
   - 支持同时处理多个聊天窗口

## 五、常见问题解决

### 问题1：应用无法读取消息

**解决方法**：
1. 确认无障碍服务已开启
2. 确认陌陌版本与应用兼容
3. 确认控件ID配置正确
   - 打开 `MomoAccessibilityService.java` 文件
   - 检查陌陌相关控件ID是否正确
   - 不同版本的陌陌可能使用不同的控件ID
4. 尝试重启应用和陌陌

### 问题2：AI回复生成失败

**解决方法**：
1. 确认AI模型API密钥配置正确
2. 确认网络连接正常
3. 尝试切换到其他AI模型
4. 查看日志信息，了解具体错误原因
   - 连接设备到电脑
   - 打开Android Studio的Logcat窗口
   - 筛选标签 `AIReplyGenerator` 查看详细日志

### 问题3：应用被陌陌检测

**解决方法**：
1. 不要过度使用自动回复功能
2. 适当调整回复间隔，模拟真实人类聊天
3. 不要在短时间内发送大量回复
4. 定期更新应用，适应陌陌的反自动化机制

### 问题4：无障碍服务频繁关闭

**解决方法**：
1. 确保应用有足够的权限
2. 不要使用系统清理工具清理应用后台
3. 尝试将应用添加到系统白名单
4. 检查是否有其他应用冲突

## 六、应用设置说明

### 1. 修改角色设定

如果您想修改AI的角色设定，请修改 `ConversationManager.java` 文件中的以下代码：

```java
// 默认角色设定
private static final String DEFAULT_ROLE_SETTING = "你是一个友好、亲切、自然的聊天助手...";
```

### 2. 修改对话历史保留时间

默认情况下，应用会清理超过7天未活跃的对话历史。如果您想修改这个时间，请修改 `BootCompleteReceiver.java` 文件中的以下代码：

```java
// 清理超过7天未活跃的对话（7天 = 7 * 24 * 60 * 60 * 1000毫秒）
conversationManager.cleanupInactiveConversations(7 * 24 * 60 * 60 * 1000);
```

### 3. 修改AI回复长度

如果您想修改AI回复的最大长度，请修改 `AIReplyGenerator.java` 文件中的以下代码：

```java
requestBody.put("max_tokens", 100); // 修改100为您想要的最大长度
```

## 七、注意事项

1. **关于权限**
   - 应用需要无障碍服务权限才能正常工作
   - 首次使用必须开启无障碍服务
   - 设备重启后可能需要重新开启服务

2. **关于电量消耗**
   - 无障碍服务会持续监听设备事件，可能增加电量消耗
   - 建议在需要时开启服务，不需要时关闭服务

3. **关于版本兼容性**
   - 不同版本的陌陌可能需要调整控件ID
   - 建议使用最新版本的陌陌

4. **关于合规性**
   - 使用本应用可能违反陌陌的用户协议
   - 请合理使用，避免过度自动化导致账号封禁
   - 作者不对使用本应用造成的任何后果负责

## 八、卸载应用

如果您不再需要使用本应用，可以通过以下方式卸载：

1. **通过系统设置卸载**
   - 进入系统设置 → 应用管理 → 找到"陌陌自动回复"
   - 点击"卸载"按钮

2. **通过应用图标卸载**
   - 在桌面找到应用图标
   - 长按图标，选择"卸载"

3. **通过Android Studio卸载**
   - 连接设备到电脑
   - 打开Android Studio
   - 点击顶部工具栏的 "Run" → "Uninstall App"

---

如果您在使用过程中遇到其他问题，欢迎随时反馈！
